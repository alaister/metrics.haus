import supabase from './supabase'

export const DEFAULT_AVATAR_SRC_URL = `data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNTYiIGhlaWdodD0iMjU2IiBmaWxsPSJub25lIiB2aWV3Qm94PSIwIDAgNTkyIDU5MiI+PGNpcmNsZSBjeD0iMjk2IiBjeT0iMjk2IiByPSIyNzYiIGZpbGw9IiNmZmYiIHN0cm9rZT0iI2ZmZiIgc3Ryb2tlLXdpZHRoPSI0MCIvPjxtYXNrIGlkPSJhIiBmaWxsPSIjZmZmIj48cGF0aCBkPSJNNTcyIDI5NmMwIDE1Mi40MzEtMTIzLjU2OSAyNzYtMjc2IDI3Ni0xNTIuNDMxIDAtMjc2LTEyMy41NjktMjc2LTI3NkMyMCAxNDMuNTY5IDE0My41NjkgMjAgMjk2IDIwYzE1Mi40MzEgMCAyNzYgMTIzLjU2OSAyNzYgMjc2WiIvPjwvbWFzaz48cGF0aCBmaWxsPSIjZmZmIiBkPSJNNTcyIDI5NmMwIDE1Mi40MzEtMTIzLjU2OSAyNzYtMjc2IDI3Ni0xNTIuNDMxIDAtMjc2LTEyMy41NjktMjc2LTI3NkMyMCAxNDMuNTY5IDE0My41NjkgMjAgMjk2IDIwYzE1Mi40MzEgMCAyNzYgMTIzLjU2OSAyNzYgMjc2WiIvPjxwYXRoIGZpbGw9IiMwMDAiIGQ9Ik05MyA0NzQuNUM5MyAzNjIuNjYyIDE4My42NjIgMjcyIDI5NS41IDI3MnYtNDBDMTYxLjU3MSAyMzIgNTMgMzQwLjU3MSA1MyA0NzQuNWg0MFpNMjk1LjUgMjcyQzQwNy4zMzggMjcyIDQ5OCAzNjIuNjYyIDQ5OCA0NzQuNWg0MEM1MzggMzQwLjU3MSA0MjkuNDI5IDIzMiAyOTUuNSAyMzJ2NDBaTTUzMiAyOTZjMCAxMzAuMzM5LTEwNS42NjEgMjM2LTIzNiAyMzZ2ODBjMTc0LjUyMiAwIDMxNi0xNDEuNDc4IDMxNi0zMTZoLTgwWk0yOTYgNTMyQzE2NS42NjEgNTMyIDYwIDQyNi4zMzkgNjAgMjk2aC04MGMwIDE3NC41MjIgMTQxLjQ3OCAzMTYgMzE2IDMxNnYtODBaTTYwIDI5NkM2MCAxNjUuNjYxIDE2NS42NjEgNjAgMjk2IDYwdi04MEMxMjEuNDc4LTIwLTIwIDEyMS40NzgtMjAgMjk2aDgwWk0yOTYgNjBjMTMwLjMzOSAwIDIzNiAxMDUuNjYxIDIzNiAyMzZoODBjMC0xNzQuNTIyLTE0MS40NzgtMzE2LTMxNi0zMTZ2ODBaIiBtYXNrPSJ1cmwoI2EpIi8+PGNpcmNsZSBjeD0iMjk2IiBjeT0iMjA0IiByPSI5NiIgZmlsbD0iI0RBREFEQSIgc3Ryb2tlPSIjMDAwIiBzdHJva2Utd2lkdGg9IjQwIi8+PC9zdmc+`

export function getAvatarUrl(path: string | null) {
  if (path === null) {
    return DEFAULT_AVATAR_SRC_URL
  }

  return supabase.storage.from('avatars').getPublicUrl(path, {
    transform: {
      width: 256,
      height: 256,
      resize: 'cover',
    },
  }).data.publicUrl
}
